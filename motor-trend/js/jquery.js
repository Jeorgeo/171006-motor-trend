function partnersMapStart(){console.log("Map start");var e=document.getElementById("partners-map"),t=$(e).data("center")||"",o=$(e).data("points")||"",i=new google.maps.LatLng(t.lat,t.lng),s=[],a=[],n=[],r=[],l=0,c={disableDefaultUI:!0,scrollwheel:!1,zoom:3,center:i,mapTypeId:google.maps.MapTypeId.ROADMAP},p=new google.maps.Map(e,c);p.setOptions({styles:mapStyles});var d=new google.maps.MarkerImage("img/maps/marker_min_purple.svg",new google.maps.Size(20,30),new google.maps.Point(0,0),new google.maps.Point(10,30));for(l=0;l<o.length;l++)s[l]=new google.maps.LatLng(o[l].lat,o[l].lng),a[l]=new google.maps.Marker({position:s[l],map:p,icon:d,title:o[l].name});for(l=0;l<o.length;l++)n[l]="<div class='infobox'><a class='infobox__close'></a><div class='infobox__text'><div class='infobox__name'>"+o[l].name+"</div><div class='infobox__info'>"+o[l].info+"</div></div></div>";for(l=0;l<o.length;l++)r[l]=new InfoBox({content:n[l],pixelOffset:new google.maps.Size(-23,-44),zIndex:null,closeBoxURL:"",isHidden:!1,visible:!0,enableEventPropagation:!0});for(l=0;l<a.length;l++)!function(e){a[e].addListener("click",function(){p.setZoom(15),p.panTo(this.getPosition()),r[e].open(p,this)})}(l);$(e).on("click",".infobox__close",function(){for(var e=0;e<r.length;e++)r[e].close()});var u=document.createElement("div"),m=document.createElement("div"),f=document.createElement("div");u.appendChild(m),u.appendChild(f),u.index=1,m.className="map-zoom__more",f.className="map-zoom__less",google.maps.event.addDomListener(m,"click",function(){p.setZoom(p.getZoom()+1)}),google.maps.event.addDomListener(f,"click",function(){p.setZoom(p.getZoom()-1)}),p.controls[google.maps.ControlPosition.LEFT_CENTER].push(u);new MarkerClusterer(p,a,{imagePath:"img/maps/m"})}function showroomMapStart(){console.log("Map start");var e=document.getElementById("showroom-map"),t=$(e).data("point")||"",o=new google.maps.LatLng(t.lat,t.lng),i={disableDefaultUI:!0,scrollwheel:!1,zoom:12,center:o,mapTypeId:google.maps.MapTypeId.ROADMAP,styles:mapStyles},s=new google.maps.Map(e,i),a=new google.maps.MarkerImage("img/maps/icon_map.png",new google.maps.Size(64,64),new google.maps.Point(0,0),new google.maps.Point(32,64)),n=(new google.maps.Marker({position:new google.maps.LatLng(t.lat,t.lng),map:s,icon:a,title:t.name}),document.createElement("div")),r=document.createElement("div"),l=document.createElement("div");n.appendChild(r),n.appendChild(l),n.index=1,r.className="map-zoom__more",l.className="map-zoom__less",google.maps.event.addDomListener(r,"click",function(){s.setZoom(s.getZoom()+1)}),google.maps.event.addDomListener(l,"click",function(){s.setZoom(s.getZoom()-1)}),s.controls[google.maps.ControlPosition.LEFT_CENTER].push(n)}function mapStart(){$("#partners-map").length&&partnersMapStart(),$("#showroom-map").length&&showroomMapStart()}var $W=$(window),$D=$(document),$B=$("body"),$HB=$("html, body"),notMobile=!0;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(notMobile=!1);var PAGE={$siteWrapper:$("#site-wrapper"),$secIntro:$("#sec-intro"),$benefitsWrap:$("#benefits-wrap"),$benefitsBack:$("#benefits-back"),$historyWrap:$("#history-wrap"),$historyBack:$("#history-back"),$compareWrap:$("#compare-wrap"),$compareMove:$("#compare-move"),$subscribeWrap:$("#subscribe-wrap"),$subscribeRotate:$("#subscribe-rotate")};PAGE.PreLoader={$overlay:$("#preloader"),$loadBar:$("#load-line"),$loadPers:$("#load-pers"),$tempDiv:"",items:[],doneStatus:0,doneNow:0,init:function(){this.getImages("body"),this.createPreloading()},getImages:function(e){var t=this;$(e).find("*:not(script)").each(function(){var e="";"none"!==$(this).css("background-image")&&(e=$(this).css("background-image"),-1==e.search("url")&&(e="")),void 0!==$(this).attr("src")&&"img"==this.tagName.toLowerCase()&&(e=$(this).attr("src")),e=e.replace('url("',""),e=e.replace("url(",""),e=e.replace('")',""),e=e.replace(")",""),e.length>0&&t.items.push(e)})},createPreloading:function(){var e=0,t=this.items.length,o=this;for(this.doneStatus=t,this.$tempDiv=$("<div></div>").appendTo("body"),this.$tempDiv.css({height:"0px",width:"0px",overflow:"hidden"}),e;e<t;e++){var i=$("<img> </img>");i.attr("src",this.items[e]),i.unbind("load").bind("load",function(){o.imgCallback()}),i.unbind("error").bind("error",function(){o.imgCallback()}),i.appendTo($(this.$tempDiv))}},imgCallback:function(){this.doneNow++},updateStatus:function(){var e=100/this.doneStatus*this.doneNow;e>99&&this.doneLoad(),this.$loadPers.text((0^e)+"%"),this.$loadBar.css("width",e+"%")},doneLoad:function(){var e=this;$(this.$tempDiv).remove(),this.$overlay.addClass("is-loaded"),setTimeout(function(){e.$overlay.addClass("is-hidden")},600)}},PAGE.PreLoader.init();var google,mapStyles=[{featureType:"all",elementType:"all",stylers:[{hue:"#ffaa00"},{saturation:"-33"},{lightness:"10"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#9c5e18"}]},{featureType:"landscape.natural.terrain",elementType:"geometry",stylers:[{visibility:"simplified"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{visibility:"simplified"}]},{featureType:"road.highway",elementType:"labels.text",stylers:[{visibility:"on"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{visibility:"simplified"}]},{featureType:"transit.line",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{saturation:"-23"},{gamma:"2.01"},{color:"#ffffff"}]},{featureType:"water",elementType:"geometry.stroke",stylers:[{saturation:"-14"}]}];$D.ready(function(){function e(){var e=document.createElement("div");e.style.overflowY="scroll",e.style.width="50px",e.style.height="50px",e.style.visibility="hidden",document.body.appendChild(e),o=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}function t(){var e=$(this).scrollTop();Math.abs(s-e)<=a||(e>s&&e>r?n.removeClass("nav-down").addClass("nav-up"):e+$W.height()<$D.height()&&n.removeClass("nav-up").addClass("nav-down"),s=e)}var o=0;e(),$.fn.scrollToTop=function(){var e=$(this);e.hide(),$W.scrollTop()>="150"&&e.fadeIn("slow"),$W.scroll(function(){$W.scrollTop()<="150"?e.fadeOut("slow"):e.fadeIn("slow")}),$(this).click(function(){$HB.velocity("scroll",{offset:0,duration:2e3,easing:"easeOutCubic"})})},$(".js-scroll-top").scrollToTop(),$(".js-scroll-to").click(function(e){var t,o=$(this),i=$(o.attr("href")||o.data("scroll"));return i.length&&(e.preventDefault(),t=i.offset().top-115,$HB.velocity("scroll",{offset:t,duration:2e3,easing:"easeOutCubic"})),!1}),$.fn.rippleEffect=function(e){var t=$(this);e||(e=.8),t.click(function(t){var o,i,s,a,n=$(this);0==n.find(".effect").length&&n.append("<span class='effect'></span>"),o=n.children(".effect"),o.removeClass("replay"),o.height()||o.width()||(i=Math.max(n.outerWidth(),n.outerHeight()),o.css({height:i*e,width:i*e})),s=t.pageX-n.offset().left-o.width()/2,a=t.pageY-n.offset().top-o.height()/2,o.css({top:a+"px",left:s+"px"}).addClass("replay")})},$(".btn").rippleEffect(1),$D.on("click",".js-youtube-init",function(){function e(){t='<iframe class="video-unit__youtube" width="740" height="480" src="https://www.youtube.com/embed/'+i+'?rel=0&autoplay=1" frameborder="0" allowfullscreen></iframe>',o.before(t),o.addClass("is-hidden")}var t,o=$(this),i=o.data("youtube");return!!i&&(e(),this)}),$D.on("click",".js-video-init",function(){var e=$(this),t=e.siblings(".video-unit__local")[0];if(!t)return!1;e.addClass("is-hidden"),t.load(),t.play()});var i,s=0,a=5,n=$("#site-header"),r=n.outerHeight();$(window).scroll(function(){i=!0}),setInterval(function(){i&&(t(),i=!1)},250),$(".js-mobmenu-toggle").click(function(){var e=$(this),t=$("#js-mobmenu"),o=$("#js-mobmodal"),i=$("#site-header");t.hasClass("is-active")?(e.removeClass("is-open"),t.removeClass("is-active"),o.removeClass("is-active"),i.removeClass("is-active")):(e.addClass("is-open"),t.addClass("is-active"),o.addClass("is-active"),i.addClass("is-active"))}),$("#js-mobmodal").click(function(){var e=$(".js-mobmenu-toggle"),t=$("#js-mobmenu"),o=$("#js-mobmodal");e.removeClass("is-open"),t.removeClass("is-active"),o.removeClass("is-active")}),$.mask.definitions.H="[0-2]",$.mask.definitions.h="[1-9]",$.mask.definitions.M="[0-5]",$.mask.definitions.m="[0-9]",$(".js-phone-mask").mask("+7 (999) 999-99-99",{placeholder:"_"}),$(".js-date-mask").mask("99.99.9999",{placeholder:"_"}),$(".js-time-mask").mask("Hh:Mm",{placeholder:"_"}),$(".js-validate").each(function(){$(this).validate({focusInvalid:!1,rules:{name:{required:!0},mail:{required:!0,email:!0},numb:{required:!0},text:{required:!0},login:{required:!0},pass:{required:!0},captcha:{required:!0}},messages:{name:"",mail:"",numb:"",text:"",login:"",pass:"",captcha:""},errorClass:"input-error",highlight:function(e,t){$(e).parent().addClass(t)},unhighlight:function(e,t){$(e).parent().removeClass(t)},submitHandler:function(e){$(e).hasClass("popup-form")&&$(e).hide().siblings(".js-form-ok").show()}})}),$(".js-gallery-slider").slick({arrows:!0,dots:!0,autoplay:!1,infinite:!1,slidesToShow:1,slidesToScroll:1,prevArrow:"<button type='button' class='slick-arrow slick-prev'></button>",nextArrow:"<button type='button' class='slick-arrow slick-next'></button>",customPaging:function(e,t){return'<a class="slick-num" role="button">'+(t+1)+"</a>"},responsive:[{breakpoint:680,settings:{dots:!1}}]}),$(".js-video-set").click(function(){var e=$(this),t=e.data("video"),o=e.data("poster");$("#video-wrap").html('<div class="video-unit__poster js-youtube-init" data-youtube="'+t+'"><img class="video-unit__img" src="'+o+'" alt="Youtube video"><a class="video-unit__start" role="button"></a></div>')}),notMobile&&(PAGE.$compareMove.scroolly([{to:"con-top - 150px = vp-top",css:{top:"0",bottom:"",position:"absolute"}},{from:"con-top - 150px = vp-top",to:"con-bottom - 100el = vp-top + 150px",css:{top:"150px",bottom:"",position:"fixed"}},{from:"con-bottom - 100el = vp-top + 150px",css:{top:"auto",bottom:"0",position:"absolute"}}],PAGE.$compareWrap),PAGE.$subscribeRotate.scroolly([{from:"con-top = vp-bottom",to:"con-bottom = vp-top",cssFrom:{transform:"rotate( 0deg )"},cssTo:{transform:"rotate( 360deg )"}}],PAGE.$subscribeWrap),PAGE.$benefitsBack.scroolly([{from:"con-top + 100px = vp-bottom",to:"con-bottom - 200px = vp-top",cssFrom:{opacity:0},cssTo:{opacity:1}}],PAGE.$benefitsWrap),PAGE.$historyBack.scroolly([{from:"con-top + 100px = vp-bottom",to:"con-bottom - 200px = vp-top",cssFrom:{opacity:0},cssTo:{opacity:1}}],PAGE.$historyWrap))}),$(window).on("load",function(){setTimeout(function(){$("#preloader").addClass("is-off")},300),$("#map-wrap").length&&$.getScript("https://api-maps.yandex.ru/2.1/?lang=ru_RU",function(){console.log("Кaрта загружена"),mapStart()}),$(".js-map-here").length>0&&$.getScript("http://maps.google.com/maps/api/js?key=AIzaSyAr3L94pBd0Dy_AR0mirpFBB7NtbgmOV9E&sensor=false",function(){console.log("Map loaded"),$.getScript("js/helpers/infobox.js",function(){console.log("Infobox loaded"),$.getScript("js/helpers/markerclusterer.js",function(){console.log("Marker clusterer loaded"),mapStart()})})})});